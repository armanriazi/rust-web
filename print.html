<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Rust-Web</title>
        <meta name="robots" content="noindex" />
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="TEMPLATE.html"><strong aria-hidden="true">1.</strong> TEMPLATE</a></li><li class="chapter-item expanded "><a href="rust/RUST.html"><strong aria-hidden="true">2.</strong> RUST</a></li><li class="chapter-item expanded "><a href="diesel/DIESEL.html"><strong aria-hidden="true">3.</strong> DIESEL</a></li><li class="chapter-item expanded "><a href="WEB_R3.html"><strong aria-hidden="true">4.</strong> WEB_R3</a></li><li class="spacer"></li><li class="chapter-item expanded "><a href="diesel/diesel_v2/DIESEL_VER_2.html"><strong aria-hidden="true">5.</strong> DIESEL_VER_2</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="diesel/diesel_v2/sqlite/SET_UP_DIESEL_SQLITE.html"><strong aria-hidden="true">5.1.</strong> SET_UP_DIESEL_SQLITE</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="diesel/diesel_v2/sqlite/getting_started_step_1/SETUP_DIESEL_STEP_1.html"><strong aria-hidden="true">5.1.1.</strong> SETUP_DIESEL_STEP_1</a></li><li class="chapter-item expanded "><a href="diesel/diesel_v2/sqlite/getting_started_step_2/SETUP_DIESEL_STEP_2.html"><strong aria-hidden="true">5.1.2.</strong> SETUP_DIESEL_STEP_2</a></li><li class="chapter-item expanded "><a href="diesel/diesel_v2/sqlite/getting_started_step_3/SETUP_DIESEL_STEP_3.html"><strong aria-hidden="true">5.1.3.</strong> SETUP_DIESEL_STEP_3</a></li><li class="spacer"></li></ol></li></ol></li><li class="chapter-item expanded "><a href="diesel/web_edu/WEB_EDU.html"><strong aria-hidden="true">6.</strong> WEB_EDU</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="diesel/web_edu/web_edu_setup/SETUP_WEB_EDU.html"><strong aria-hidden="true">6.1.</strong> SETUP_WEB_EDU</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Rust-Web</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="intro"><a class="header" href="#intro">Intro</a></h1>
<p><a href="rust/RUST.html">RUST</a></p>
<p><a href="diesel/DIESEL.html">DIESEL</a></p>
<h1 id="template"><a class="header" href="#template">Template</a></h1>
<pre><code>/*
#![allow(dead_code, unused_variables)]
packtpub-string-bin-ex-1

## Commands

```cargo run -q -p packtpub-types-string_bin --bin packtpub-string-bin-ex-1```

## What
`TODO`

## How
`TODO`

# Arguments

* `Arg1` - This is the [your type] to [your verb] the [your struct/func name]

# Return
`assert:true`

## Example
 //```rust,compile_fail,ignore
*/
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="rust"><a class="header" href="#rust">Rust</a></h1>
<h2 id="commands"><a class="header" href="#commands">Commands</a></h2>
<p><code>time cargo run</code></p>
<p><code>cargo doc  --workspace --message-format short --no-deps --open --color always</code></p>
<p><code>cargo test --doc --workspace</code></p>
<h2 id="use-cases"><a class="header" href="#use-cases">Use-cases</a></h2>
<blockquote>
<p>Hostile environments: In situations where <strong>safety</strong> is of utmost concern, Rust’s guarantees are a perfect fit.</p>
</blockquote>
<ul>
<li>Concurrent</li>
<li>Safe programming</li>
<li>Processing</li>
<li>Replacing legacy C or C++
&gt;</li>
</ul>
<blockquote>
<p>npm chose Rust to handle CPU-bound bottlenecks.</p>
</blockquote>
<h2 id="syntax"><a class="header" href="#syntax">Syntax</a></h2>
<blockquote>
<p>path`:	::</p>
</blockquote>
<blockquote>
<p><code>!</code>: that’s known in type theory lingo as the empty type because it has no values. We prefer to call it the never type.Functions that return never are called diverging functions.</p>
</blockquote>
<blockquote>
<p><code>?Sized</code>: T may or may not be Sized-Trait syntax with this meaning is only available for Sized, this notation overrides the default that generic types must have a known size at compile time. not any other traits.</p>
</blockquote>
<h2 id="safety"><a class="header" href="#safety">Safety</a></h2>
<p><img src="rust/./assets/images/Screenshot%20from%202022-12-14%2017-53-56.png" alt="safetay-control" /></p>
<blockquote>
<p>It guarantees that your program is memory-safe without imposing any runtime costs.</p>
</blockquote>
<h3 id="goal-of-rust-safety"><a class="header" href="#goal-of-rust-safety">Goal of Rust: Safety</a></h3>
<blockquote>
<p>Rust programs are free from:</p>
</blockquote>
<ol>
<li>
<p><strong>Dangling pointers</strong>— <u><em>Live references</em></u> to data that has become invalid over the course of the program (see [[ria-data-csv-bin]])</p>
</li>
<li>
<p><strong>Data races</strong>—The inability to determine how a program will behave from <u><em>run to run</em></u> because external factors change (see [[ria-race]])</p>
</li>
<li>
<p><strong>Buffer overflow</strong>—An attempt to access the 12th element of an <u><em>array</em></u> with only 6 elements (see listing 1.5)</p>
</li>
<li>
<p><strong>Iterator invalidation</strong>—An issue caused by something that is iterated over after being <u><em>altered midway</em> through</u> (see listing 1.6)</p>
</li>
</ol>
<h2 id="memory-model"><a class="header" href="#memory-model">Memory model</a></h2>
<h3 id="raii"><a class="header" href="#raii">RAII</a></h3>
<p>Rust uses [[RAII]] (resource acquisition is initialization) to keep track of when variables and all their references are in and out of scope. Once they are out of scope, memory can be released. The borrow checker will not allow references to out of scope variables, and it only allows one mutable reference or multiple immutable references, but never both.</p>
<h3 id="explicit"><a class="header" href="#explicit">Explicit</a></h3>
<h3 id="rust-programs-have-3-memory"><a class="header" href="#rust-programs-have-3-memory">Rust programs have 3 memory</a></h3>
<p>(regions where data is stored)</p>
<h4 id="data-memory"><a class="header" href="#data-memory">data memory</a></h4>
<p>For data that is fixed in size and static (i.e. always available through life of program). Consider the text in your program (e.g. &quot;Hello World!&quot;): This text's bytes are only ever read from one place and therefore can be stored in this region. Compilers make lots of optimizations with this kind of data, and they are generally considered very fast to use since locations are known and fixed.</p>
<h4 id="stack-memory"><a class="header" href="#stack-memory">stack memory</a></h4>
<p>For data that is declared as variables within a function. The location of this memory never changes for the duration of a function call; because of this compilers can optimize code so stack data is very fast to access.</p>
<h4 id="heap-memory"><a class="header" href="#heap-memory">heap memory</a></h4>
<p>For data that is created while the application is running. Data in this region may be added, moved, removed, resized, etc. Because of its dynamic nature it's generally considered slower to use, but it allows for much more creative usages of memory. When data is added to this region we call it an allocation. When data is removed from this section we call it a deallocation. Data with an unknown size at compile time or a size that might change must be stored on the heap instead.</p>
<blockquote>
<p>String struct is also on stack,but holds a reference to data on heap</p>
</blockquote>
<pre><code>  let s= Struct{x:y,z:w}  
</code></pre>
<h2 id="numerous-community-tools"><a class="header" href="#numerous-community-tools">Numerous community tools</a></h2>
<p>(for improving code quality and productivity)</p>
<blockquote>
<p>rust-clippy, an advanced linter and style tool - This warns you of common mistakes and potential <strong>code smells</strong>. Clippy relies on <strong>compiler plugins</strong> that are marked as unstable, so it is available with nightly Rust only. With rustup, you can switch to nightly easily.</p>
<p>rustfmt, an opinionated code formatter-It formats code according to conventions that are mentioned in the Rust style guide.
rust-analyzer, full-featured IDE integration for the Rust language</p>
<p><strong>sccache</strong>, a compiler cache for rustc</p>
</blockquote>
<h3 id="stdprelude"><a class="header" href="#stdprelude">std:prelude</a></h3>
<p>To understand what is included in local scope by default(like try_into()), you should investigate the std:: [[prelude]] module. Its documentation is available online at <a href="https://doc.rust-lang.org/std/prelude/index.html">prelude</a></p>
<h2 id="version"><a class="header" href="#version">Version</a></h2>
<p>Internally, Cargo uses the <strong>semver</strong> crate for parsing the versions</p>
<h2 id="glossery"><a class="header" href="#glossery">Glossery</a></h2>
<p><a href="https://doc.rust-lang.org/nightly/reference/glossary.html">Rust Glossary</a></p>
<p><a href="https://doc.rust-lang.org/reference/notation.html">Rust Notation</a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="diesel"><a class="header" href="#diesel">Diesel</a></h1>
<p>Diesel is one of the most popular and stable ORM tools in Rust.</p>
<p>In this lesson, we’ll learn to install and configure it for our projects.</p>
<p>We want to install the required database drivers. Instructions for installing these drivers for Linux/Mac can be found here.</p>
<p>Install database drivers on Windows
Instructions for installing the three most popular relational database management systems (RDBMS) on Windows are below.</p>
<h2 id="sqlite"><a class="header" href="#sqlite">SQLite</a></h2>
<p>Download precompile Windows binaries.
Extract both archives to folder C:\sqlite3. We can name this folder anything.
Open developer command prompt for Visual Studio (VS) by typing “developer command” in the Windows search bar.
Go to the folder with the extracted source code and binary files (via opened cmd or PowerShell).
Run lib /DEF:sqlite3.def /OUT:sqlite3.lib /MACHINE:x64.
Add C:\sqlite3 to the environment variable PATH.
Create an environment variable called SQLITE3_LIB_DIR also pointing to C:\sqlite3.</p>
<h2 id="mysql"><a class="header" href="#mysql">MySQL</a></h2>
<p>Download the MySQL connector.</p>
<p>Locate mysqlclient.lib. It might be installed in C:\Program Files\MySQL\MySQL Connector C 6.1\lib\vs14 if you use the MSI Installer.</p>
<p>Create an environment variable called MYSQLCLIENT_LIB_DIR that points to the previous folder.</p>
<h2 id="postgresql"><a class="header" href="#postgresql">PostgreSQL</a></h2>
<p>Download the installer and install PostgreSQL.
Add the bin directory to the PATH environment variable.
Create a variable named PQ_LIB_DIR pointing to the lib directory.
Prepare Diesel
Run the next command with the corresponding RDBMS. In the example, we are using SQLite.</p>
<pre><code>cargo install diesel_cli --no-default-features --features sqlite
</code></pre>
<h3 id="setup-orm"><a class="header" href="#setup-orm">Setup ORM</a></h3>
<p>Finally, we can create our database with the below command.</p>
<pre><code>diesel setup
</code></pre>
<p>We need to specify the database_url to create the testing database.</p>
<pre><code>diesel setup --database-url='web_edu_test.sqlite
</code></pre>
<h2 id="migration"><a class="header" href="#migration">Migration</a></h2>
<h3 id="migration-create-products"><a class="header" href="#migration-create-products">Migration Create Products</a></h3>
<pre><code>diesel migration generate create_products
</code></pre>
<p>The previous command will create two files named up.sql and down.sql inside the migrations folder.</p>
<p>We’ll enter the below code in the up.sql file.</p>
<pre><code class="language-sql">CREATE TABLE products (
  id INTEGER PRIMARY KEY,
  name VARCHAR NOT NULL,
  cost DOUBLE NOT NULL,
  active BOOLEAN NOT NULL DEFAULT 0 --Sqlite does not have a Boolean value
)
</code></pre>
<p>Let’s work with the down.sql file now.</p>
<pre><code>drop table products
</code></pre>
<p>Next:</p>
<pre><code>diesel migration run
</code></pre>
<hr />
<h3 id="migration-product-variants"><a class="header" href="#migration-product-variants">Migration Product Variants</a></h3>
<p>Next:
We need to create another table to save shoe variants.</p>
<pre><code>diesel migration generate create_variants
</code></pre>
<p>Below is how the up.sql file will look.</p>
<pre><code class="language-sql">CREATE TABLE variants (
   id INTEGER PRIMARY KEY NOT NULL, 
   name VARCHAR NOT NULL
);

CREATE TABLE products_variants (
   id INTEGER PRIMARY KEY NOT NULL, 
   variant_id INTEGER NOT NULL,
   product_id INTEGER NOT NULL,
   value VARCHAR,
   FOREIGN KEY(variant_id) REFERENCES variants(id),
   FOREIGN KEY(product_id) REFERENCES products(id)   
);
</code></pre>
<p>Below is how the down.sql file.</p>
<pre><code>drop table variants;
drop table products_variants;
</code></pre>
<h3 id="migration-for-test-db"><a class="header" href="#migration-for-test-db">Migration For Test DB</a></h3>
<p>We did not include indexes in the above code widgets, but you should do so according to your frequent queries. Next, we run the migrations.</p>
<pre><code>diesel migration run
diesel migration run --database-url='db/web_edu_test.sqlite'
</code></pre>
<h3 id="migration-for-edit-form"><a class="header" href="#migration-for-edit-form">Migration For Edit Form</a></h3>
<p>The delete method is easier to implement. However, we should make some modifications in our SQL first. We open the up.sql file and update it with the below commands.
The clause ON DELETE CASCADE will allow us to delete the relations with variants every time we delete a product.</p>
<pre><code class="language-sql">CREATE TABLE products_variants (
   id INTEGER PRIMARY KEY NOT NULL, 
   variant_id INTEGER NOT NULL,
   product_id INTEGER NOT NULL,
   value VARCHAR,
   FOREIGN KEY(variant_id) REFERENCES variants(id) ON DELETE CASCADE,
   FOREIGN KEY(product_id) REFERENCES products(id) ON DELETE CASCADE
);
</code></pre>
<p>Notice(In code): 
We need to be aware that SQLite does not enforce foreign keys, so we need to tell the database with the following command: </p>
<pre><code>connection.execute(&quot;PRAGMA foreign_keys = ON&quot;).unwrap();
</code></pre>
<p>We can see a couple of interesting lines in this test. First, we have the annotation #[should_panic(expected = &quot;NotFound&quot;)]We use this annotation to tell Rust that this test should effectively panic. This will happen when we try to show an inexistent product and unwrap an Err result.</p>
<pre><code>#[should_panic(expected = &quot;NotFound&quot;)]
</code></pre>
<h3 id="how-to-make-a-select--where-exists-query-with-diesel"><a class="header" href="#how-to-make-a-select--where-exists-query-with-diesel">How to make a <code>SELECT .... WHERE EXISTS</code> query with diesel?</a></h3>
<pre><code class="language-sql">SELECT * FROM user AS u
WHERE EXISTS(
    SELECT 0 FROM address AS a
    WHERE a.user_id = u.id
        AND a.city = 'Berlin'
)
</code></pre>
<blockquote>
</blockquote>
<pre><pre class="playground"><code class="language-rust no_run edition2021">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>diesel::table! {
    addresses (id) {
        id -&gt; Int4,
        user_id -&gt; Int4,
        city -&gt; Nullable&lt;Varchar&gt;,
    }
}

diesel::table! {
    users (id) {
        id -&gt; Int4,
        name -&gt; Varchar,
    }
}

diesel::joinable!(addresses -&gt; users (user_id));

diesel::allow_tables_to_appear_in_same_query!(
    addresses,
    users,
);
<span class="boring">}
</span></code></pre></pre>
<blockquote>
<p>Response</p>
</blockquote>
<pre><pre class="playground"><code class="language-rust edition2021">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>let sub_query = addresses::table
    .select(0.into_sql::&lt;diesel::sql_types::Integer&gt;())
    .filter(addresses::user_id.eq(users::id))
    .filter(addresses::city.eq(&quot;Berlin&quot;));
let result = users::table.filter(diesel::dsl::exists(sub_query)).load::&lt;CompatibleType&gt;(&amp;mut conn)?;
<span class="boring">}
</span></code></pre></pre>
<h3 id="sorting-and-filtering"><a class="header" href="#sorting-and-filtering">Sorting and Filtering</a></h3>
<p><a href="https://cloudmaker.dev/sorting-and-filtering-with-diesel/">sorting-and-filtering-with-diesel</a></p>
<h1 id="references"><a class="header" href="#references">References</a></h1>
<p><a href="https://diesel.rs/guides/migration_guide.html#2-0-0-no_arg_sql_function">no_arg_sql_function</a></p>
<div style="break-before: page; page-break-before: always;"></div><blockquote>
<p><code>tags</code> [[zip]] [[inner_join]] [[belonging_to]] [[grouped_by]] [[filter]] [[TextExpressionMethods]] [[grouped_by]] [[PRAGMA]]</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><p>[[SET_UP_DIESEL_SQLITE]]</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="rs-diesel-sqlite"><a class="header" href="#rs-diesel-sqlite"><code>rs-diesel-sqlite</code></a></h1>
<blockquote>
<p>Diesel's <code>Getting Started</code> guide using SQLite instead of Postgresql</p>
</blockquote>
<hr />
<p>[[SETUP_DIESEL_STEP_1]]</p>
<p>[[SETUP_DIESEL_STEP_2]]</p>
<p>[[SETUP_DIESEL_STEP_3]]</p>
<hr />
<div style="break-before: page; page-break-before: always;"></div><h1 id="setup"><a class="header" href="#setup">Setup</a></h1>
<hr />
<ol>
<li>First install diesel_cli_ext:</li>
</ol>
<pre><code>cargo install diesel_cli_ext
</code></pre>
<ol start="2">
<li>You would have to generate your schema file the diesel way if you haven't yet:</li>
</ol>
<pre><code>diesel print-schema &gt; src/schema.rs  --database-url='../db/diesel2_sample_steps.sqlite'
</code></pre>
<ol start="3">
<li>generate the models file(optional in this step):</li>
</ol>
<pre><code>diesel_ext --model &gt; src/model.rs
</code></pre>
<ol start="4">
<li>setup</li>
</ol>
<pre><code>diesel setup --database-url='../db/diesel2_sample_steps.sqlite'
</code></pre>
<ol start="5">
<li>create migrations folder</li>
</ol>
<pre><code>mkdir ./migrations
</code></pre>
<ol start="6">
<li>generate and fill out up, down.sql</li>
</ol>
<pre><code>diesel migration generate posts --migration-dir='migrations'
</code></pre>
<ol start="7">
<li>migration</li>
</ol>
<pre><code>diesel migration run --database-url='../db/diesel2_sample_steps.sqlite' 
</code></pre>
<ol start="8">
<li>
<p>return to step 2 for cheking it is nessecarry to check schema file, is it generated by step 7 or not?</p>
</li>
<li>
<p>check created tables in db</p>
</li>
</ol>
<pre><code>sqlite3 ../db/diesel2_sample_steps.sqlite
</code></pre>
<hr />
<h2>diesel migration revert
diesel migration redo</h2>
<div style="break-before: page; page-break-before: always;"></div><h1 id="setup-1"><a class="header" href="#setup-1">Setup</a></h1>
<hr />
<ol>
<li>First install diesel_cli_ext:</li>
</ol>
<pre><code>cargo install diesel_cli_ext
</code></pre>
<ol start="2">
<li>You would have to generate your schema file the diesel way if you haven't yet:</li>
</ol>
<pre><code>diesel print-schema &gt; src/schema.rs  --database-url='../db/diesel2_sample_steps.sqlite'
</code></pre>
<ol start="3">
<li>generate the models file(optional in this step):</li>
</ol>
<pre><code>diesel_ext --model &gt; src/model.rs
</code></pre>
<ol start="4">
<li>setup</li>
</ol>
<pre><code>diesel setup --database-url='../db/diesel2_sample_steps.sqlite'
</code></pre>
<ol start="5">
<li>create migrations folder</li>
</ol>
<pre><code>mkdir ./migrations
</code></pre>
<ol start="6">
<li>generate and fill out up, down.sql</li>
</ol>
<pre><code>diesel migration generate posts --migration-dir='migrations'
</code></pre>
<ol start="7">
<li>migration</li>
</ol>
<pre><code>diesel migration run --database-url='../db/diesel2_sample_steps.sqlite' 
</code></pre>
<ol start="8">
<li>
<p>return to step 2 for cheking it is nessecarry to check schema file, is it generated by step 7 or not?</p>
</li>
<li>
<p>check created tables in db</p>
</li>
</ol>
<pre><code>sqlite3 ../db/diesel2_sample_steps.sqlite
</code></pre>
<hr />
<h2>diesel migration revert
diesel migration redo</h2>
<div style="break-before: page; page-break-before: always;"></div><h1 id="setup-2"><a class="header" href="#setup-2">Setup</a></h1>
<hr />
<ol>
<li>First install diesel_cli_ext:</li>
</ol>
<pre><code>cargo install diesel_cli_ext
</code></pre>
<ol start="2">
<li>You would have to generate your schema file the diesel way if you haven't yet:</li>
</ol>
<pre><code>diesel print-schema &gt; src/schema.rs  --database-url='../db/diesel2_sample_steps.sqlite'
</code></pre>
<ol start="3">
<li>generate the models file(optional in this step):</li>
</ol>
<pre><code>diesel_ext --model &gt; src/model.rs
</code></pre>
<ol start="4">
<li>setup</li>
</ol>
<pre><code>diesel setup --database-url='../db/diesel2_sample_steps.sqlite'
</code></pre>
<ol start="5">
<li>create migrations folder</li>
</ol>
<pre><code>mkdir ./migrations
</code></pre>
<ol start="6">
<li>generate and fill out up, down.sql</li>
</ol>
<pre><code>diesel migration generate posts --migration-dir='migrations'
</code></pre>
<ol start="7">
<li>migration</li>
</ol>
<pre><code>diesel migration run --database-url='../db/diesel2_sample_steps.sqlite' 
</code></pre>
<ol start="8">
<li>
<p>return to step 2 for cheking it is nessecarry to check schema file, is it generated by step 7 or not?</p>
</li>
<li>
<p>check created tables in db</p>
</li>
</ol>
<pre><code>sqlite3 ../db/diesel2_sample_steps.sqlite
</code></pre>
<hr />
<h2>diesel migration revert
diesel migration redo</h2>
<div style="break-before: page; page-break-before: always;"></div><p>[[SETUP_WEB_EDU]]</p>
<hr />
<blockquote>
<p><code>tags</code> [[zip]] [[inner_join]] [[belonging_to]] [[grouped_by]] [[filter]] [[TextExpressionMethods]] [[grouped_by]] [[PRAGMA]]</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="setup-3"><a class="header" href="#setup-3">Setup</a></h1>
<hr />
<ol>
<li>First install diesel_cli_ext:</li>
</ol>
<pre><code>cargo install diesel_cli_ext
</code></pre>
<ol start="2">
<li>You would have to generate your schema file the diesel way if you haven't yet:</li>
</ol>
<pre><code>diesel print-schema &gt; ../web_edu_lib/src/schema.rs --database-url='./db/web_edu.sqlite'
diesel print-schema &gt; ../web_edu_lib/src/schema.rs --database-url='./db/web_edu_test.sqlite'
</code></pre>
<ol start="3">
<li>generate the models file(optional in this step):</li>
</ol>
<pre><code>diesel_ext --model &gt; workspace/web_edu/web_edu_lib/src/model.rs
</code></pre>
<ol start="4">
<li>setup</li>
</ol>
<pre><code>diesel setup --database-url='./db/web_edu.sqlite'
diesel setup --database-url='./db/web_edu_test.sqlite'
</code></pre>
<ol start="5">
<li>create migrations folder</li>
</ol>
<pre><code>mkdir ./migrations
</code></pre>
<ol start="6">
<li>generate and fill out up, down.sql</li>
</ol>
<pre><code>diesel migration generate create_products --migration-dir='./migrations'
diesel migration generate create_variants --migration-dir='./migrations'
diesel migration generate create_sales --migration-dir='./migrations'
</code></pre>
<ol start="7">
<li>migration</li>
</ol>
<pre><code>diesel migration run --database-url='./db/web_edu.sqlite' --migration-dir='./migrations/2023-02-14-103809_create_products'
diesel migration run --database-url='./db/web_edu_test.sqlite' --migration-dir='./migrations/2023-02-14-103809_create_products'
</code></pre>
<blockquote>
</blockquote>
<pre><code>diesel migration run --database-url='./db/web_edu.sqlite' --migration-dir='./migrations/2023-02-14-104325_create_variants'
diesel migration run --database-url='./db/web_edu_test.sqlite' --migration-dir='./migrations/2023-02-14-104325_create_variants'
</code></pre>
<blockquote>
</blockquote>
<pre><code>diesel migration run --database-url='./db/web_edu.sqlite' --migration-dir='./migrations/2023-02-23-173809_create_sales'
diesel migration run --database-url='./db/web_edu_test.sqlite' --migration-dir='./migrations/2023-02-23-173809_create_sales'
</code></pre>
<ol start="8">
<li>
<p>return to step 2 for cheking it is nessecarry to check schema file, is it generated by step 7 or not?</p>
</li>
<li>
<p>check created tables in db</p>
</li>
</ol>
<pre><code>sqlite3 ./db/web_edu.sqlite
sqlite3 ./db/web_edu_test.sqlite

</code></pre>
<pre><code>.tables
</code></pre>
<hr />
<h2>diesel migration revert
diesel migration redo</h2>
<h2>[print_schema]
import_types = [ &quot;crate::schema::<em>&quot; ]
import_types = [&quot;diesel::sql_types::</em>&quot;, &quot;diesel_full_text_search::types::*&quot;]
filter = { only_tables = [&quot;products&quot;] }</h2>
<blockquote>
<p>setup_db.sh</p>
</blockquote>
<pre><code>#!/usr/bin/env bash
cd $(dirname &quot;$0&quot;)
sqlite3 ../weather.db &lt; db.sql
sqlite3 -csv ../weather.db &quot;.import nyc_centralpark_weather.csv nyc_weather&quot;
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
    </body>
</html>
